diff --git a/backend/ayanavitabackend/app/api/src/orders/orders.controller.ts b/backend/ayanavitabackend/app/api/src/orders/orders.controller.ts
index 81062269c2331bf0b8fcaa03efb526c944c6fcc1..bc8e5dd6f92e38f6bd802665d87c112141d7df05 100644
--- a/backend/ayanavitabackend/app/api/src/orders/orders.controller.ts
+++ b/backend/ayanavitabackend/app/api/src/orders/orders.controller.ts
@@ -1,71 +1,51 @@
 import {
-  Body,
   Controller,
   Get,
-  Headers,
   Param,
   ParseIntPipe,
   Post,
   Query,
   UseGuards,
 } from '@nestjs/common'
 import { OrdersService } from './orders.service'
 import { AccessTokenGuard } from '../auth/guards/access-token.guard'
 import { RolesGuard } from '../auth/guards/roles.guard'
 import { Roles } from '../auth/decorators/roles.decorator'
 import { CurrentUser } from '../auth/decorators/current-user.decorator'

 type JwtUser = { sub: number; role: string }

 @UseGuards(AccessTokenGuard)
 @Controller()
 export class OrdersController {
   constructor(private readonly orders: OrdersService) {}

   // USER: tạo order theo course
   @Post('courses/:id/order')
   create(@CurrentUser() user: JwtUser, @Param('id', ParseIntPipe) id: number) {
     return this.orders.createOrder(user.sub, id)
   }

   // USER: xem orders của tôi
   @Get('me/orders')
   myOrders(@CurrentUser() user: JwtUser) {
     return this.orders.myOrders(user.sub)
   }

   // ADMIN: list orders cho Admin UI
   // FE gọi: GET /orders?status=PENDING&q=abc
   @UseGuards(RolesGuard)
   @Roles('ADMIN')
   @Get('orders')
   list(@Query('status') status?: string, @Query('q') q?: string) {
     return this.orders.list({ status, q })
   }

   // ADMIN: mark paid (kích hoạt enrollment)
   @UseGuards(RolesGuard)
   @Roles('ADMIN')
   @Post('orders/:id/mark-paid')
   markPaid(@Param('id', ParseIntPipe) id: number) {
     return this.orders.markPaid(id)
   }
 }
-
-@Controller('hooks')
-export class SepayWebhookController {
-  constructor(private readonly orders: OrdersService) {}
-
-  @Post('sepay-payment')
-  async handlePayment(
-    @Headers('authorization') authorization?: string,
-    @Headers('x-sepay-key') xSepayKey?: string,
-    @Headers('x-api-key') xApiKey?: string,
-    @Body() payload?: any,
-  ) {
-    const token = xSepayKey ?? xApiKey ?? authorization?.replace(/^Bearer\s+/i, '').trim()
-    await this.orders.assertWebhookKey(token)
-
-    return this.orders.handleSepayWebhook(payload)
-  }
-}
diff --git a/backend/ayanavitabackend/app/api/src/orders/orders.module.ts b/backend/ayanavitabackend/app/api/src/orders/orders.module.ts
index cbdbced768eefa72f2cf1da0a1ea40bb97b71825..fee534ae91c3192cd6f47405876a0ebe7a8ed14d 100644
--- a/backend/ayanavitabackend/app/api/src/orders/orders.module.ts
+++ b/backend/ayanavitabackend/app/api/src/orders/orders.module.ts
@@ -1,11 +1,12 @@
 import { Module } from '@nestjs/common'
 import { PrismaModule } from '../prisma/prisma.module'
-import { OrdersController, SepayWebhookController } from './orders.controller'
+import { OrdersController } from './orders.controller'
 import { OrdersService } from './orders.service'
+import { SepayWebhookController } from './sepay-webhook.controller'

 @Module({
   imports: [PrismaModule],
   controllers: [OrdersController, SepayWebhookController],
   providers: [OrdersService],
 })
 export class OrdersModule {}
diff --git a/backend/ayanavitabackend/app/api/src/orders/sepay-webhook.controller.ts b/backend/ayanavitabackend/app/api/src/orders/sepay-webhook.controller.ts
index de5c8e452f617db6dd77cb97b96f4ae344daf114..52c74dd39538b91d5037ff608ce93c87e8f8f263 100644
--- a/backend/ayanavitabackend/app/api/src/orders/sepay-webhook.controller.ts
+++ b/backend/ayanavitabackend/app/api/src/orders/sepay-webhook.controller.ts
@@ -1,29 +1,27 @@
 import { Body, Controller, Headers, Post, UnauthorizedException } from '@nestjs/common'
 import { OrdersService } from './orders.service'

 @Controller('hooks')
 export class SepayWebhookController {
   constructor(private readonly orders: OrdersService) {}

   @Post('sepay-payment')
   async handlePayment(
-      @Headers('authorization') authorization?: string,
-      @Body() payload?: any,
+    @Headers('authorization') authorization?: string,
+    @Headers('x-sepay-key') xSepayKey?: string,
+    @Headers('x-api-key') xApiKey?: string,
+    @Body() payload?: any,
   ) {
-    if (!authorization) {
-      throw new UnauthorizedException('Missing Authorization header')
-    }
+    const bearerToken = authorization?.replace(/^Bearer\s+/i, '').trim()
+    const apiKeyToken = authorization?.match(/^Apikey\s+(.+)$/i)?.[1]?.trim()
+    const token = xSepayKey ?? xApiKey ?? apiKeyToken ?? bearerToken

-    // SePay gửi: Authorization: Apikey YOUR_KEY
-    const match = authorization.match(/^Apikey\s+(.+)$/i)
-    if (!match) {
-      throw new UnauthorizedException('Invalid Authorization format')
+    if (!token) {
+      throw new UnauthorizedException('Missing webhook key')
     }

-    const apiKey = match[1].trim()
-
-    await this.orders.assertWebhookKey(apiKey)
+    await this.orders.assertWebhookKey(token)

     return this.orders.handleSepayWebhook(payload)
   }
-}
\ No newline at end of file
+}
