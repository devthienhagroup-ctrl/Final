diff --git a/backend/ayanavitabackend/app/api/src/auth/auth.service.ts b/backend/ayanavitabackend/app/api/src/auth/auth.service.ts
index 9d9e84ef72f321a6d0dfd0ef5e7215d7aa3183c8..e2e2c6e8a4dce33293c07d63fa0af51d389fe164 100644
--- a/backend/ayanavitabackend/app/api/src/auth/auth.service.ts
+++ b/backend/ayanavitabackend/app/api/src/auth/auth.service.ts
@@ -16,101 +16,124 @@ import { VerifyOtpDto } from './dto/verify-otp.dto'

 type AuthJwtPayload = { sub: number; email: string; role: string; scopeType?: string | null; permissions: string[] }

 @Injectable()
 export class AuthService {
   private readonly logger = new Logger(AuthService.name)

   constructor(
     private readonly prisma: PrismaService,
     private readonly jwt: JwtService,
   ) {}

   async register(dto: RegisterDto) {
     const exists = await this.prisma.user.findUnique({ where: { email: dto.email } })
     if (exists) throw new ForbiddenException('Email đã tồn tại, vui lòng dùng email khác/ hoặc đăng nhập !')

     const passwordHash = await bcrypt.hash(dto.password, 10)

     const user = await this.prisma.user.create({
       data: {
         email: dto.email,
         password: passwordHash,
         name: dto.name,
         role: 'USER',
       },
-      select: { id: true, email: true, name: true, role: true, birthDate: true, gender: true, address: true },
+      select: {
+        id: true,
+        email: true,
+        name: true,
+        role: true,
+        birthDate: true,
+        gender: true,
+        address: true,
+        roleRef: {
+          include: { permissions: { include: { permission: true } } },
+        },
+      },
     })

     const role = user.roleRef?.code ?? user.role
     const scopeType = user.roleRef?.scopeType ?? null
     const permissions = user.roleRef?.permissions.map((rp) => rp.permission.code) ?? []

     const tokens = await this.issueTokens(user.id, user.email, role, scopeType, permissions)
     await this.setRefreshTokenHash(user.id, tokens.refreshToken)

     return { user, ...tokens }
   }

   async sendOtp(dto: SendOtpDto) {
     const email = dto.email.trim().toLowerCase()
     const exists = await this.prisma.user.findUnique({ where: { email } })
     if (exists) throw new ForbiddenException('Email đã tồn tại, vui lòng dùng email khác/ hoặc đăng nhập !')

     await this.issueOtp(email, 'xác nhận đăng ký AYANAVITA')
     return { success: true, expiresInSeconds: 300 }
   }

   async registerNew(dto: RegisterNewDto) {
     if (!dto.acceptedPolicy) throw new ForbiddenException('Bạn phải chấp nhận chính sách')

     const email = dto.email.trim().toLowerCase()
     const exists = await this.prisma.user.findUnique({ where: { email } })
     if (exists) throw new ForbiddenException('Email đã tồn tại, vui lòng dùng email khác/ hoặc đăng nhập !')

     const otpRow = await this.prisma.registrationOtp.findUnique({ where: { email } })
     if (!otpRow || otpRow.usedAt || otpRow.code !== dto.otp) {
       throw new ForbiddenException('OTP không hợp lệ')
     }
     if (otpRow.expiresAt.getTime() < Date.now()) {
       throw new ForbiddenException('OTP đã hết hạn')
     }

     const passwordHash = await bcrypt.hash(dto.password, 10)

     const user = await this.prisma.user.create({
       data: {
         email,
         password: passwordHash,
         name: dto.name,
         phone: dto.phone,
         role: 'USER',
         birthDate: dto.birthDate ? new Date(dto.birthDate) : undefined,
         gender: dto.gender,
         address: dto.address,
       },
-      select: { id: true, email: true, name: true, role: true, phone: true, birthDate: true, gender: true, address: true },
+      select: {
+        id: true,
+        email: true,
+        name: true,
+        role: true,
+        phone: true,
+        birthDate: true,
+        gender: true,
+        address: true,
+        roleRef: {
+          include: { permissions: { include: { permission: true } } },
+        },
+      },
     })

     await this.prisma.registrationOtp.update({
       where: { email },
       data: { usedAt: new Date() },
     })

     const role = user.roleRef?.code ?? user.role
     const scopeType = user.roleRef?.scopeType ?? null
     const permissions = user.roleRef?.permissions.map((rp) => rp.permission.code) ?? []

     const tokens = await this.issueTokens(user.id, user.email, role, scopeType, permissions)
     await this.setRefreshTokenHash(user.id, tokens.refreshToken)

     return { user, ...tokens }
   }

   async getProfile(userId: number) {
     const user = await this.prisma.user.findUnique({
       where: { id: userId },
       select: {
         id: true,
         email: true,
         name: true,
         phone: true,
